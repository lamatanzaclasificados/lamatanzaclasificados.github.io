
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Popup Lottie Corregido</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <script src="/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="estilos.css">
    <link rel="stylesheet" href="css/estilos2.css">
    <link rel="stylesheet" href="/css/magnific-popup.min.css">
  <style>
    .popup-controls-wrapper {
      background: rgba(0, 0, 0, 0.7);
      padding: 10px;
      border-radius: 10px;
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
      z-index: 1050;
    }
    .popup-button a {
      font-size: 18px;
      padding: 10px 20px;
      background-color: #2eb01e;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      display: inline-block;
    }
    .lottie-button {
      width: 40px;
      height: 40px;
      cursor: pointer;
      position: relative;
    }
  </style>
</head>
<body>

<!-- <h2>Imagen de prueba con popup</h2>
<a href="https://via.placeholder.com/600" class="popup-image" data-link="https://wa.link/demo" name="Valentina">
  <img src="https://via.placeholder.com/150" alt="Ejemplo">
</a> -->
<header data-bs-theme="dark">
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <div class="container-fluid">
          <a class="navbar-brand" href="#">La Matanza Clasificados</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
              aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
              <ul class="navbar-nav me-auto mb-2 mb-md-0">
                  <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="#">Home</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="#">Link</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link disabled" aria-disabled="true">Contactanos</a>
                  </li>
              </ul>
          </div>
      </div>
  </nav>
</header>
<main>
<div class="container">
  <div class="row">
      <div class="col-lg-12 text-center my-2">
          <img src="/img/boton-2.webp" width="100%" height="auto" alt="">
      </div>
  </div>
  <div class="portfolio-menu mt-2 mb-4">
      <ul>
          <li class="btn btn-outline-dark active" data-filter="*">Todo</li>
          <li class="btn btn-outline-dark" data-filter=".estet">Estetica</li>
          <li class="btn btn-outline-dark" data-filter=".tecnico">Tecnicos</li>
          <li class="btn btn-outline-dark text" data-filter=".abog">Abogados/Gestores</li>
          <li class="btn btn-outline-dark text" data-filter=".clases">Clases/Cursos</li>
          <li class="btn btn-outline-dark text" data-filter=".lava">Lavadero de autos</li>
      </ul>
  </div>
  <div class="portfolio-item row">
      <div class="item gts estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio1 a.jpg" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/99wodj" name="Valentina" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio1 a.jpg" alt="">
          </a>
      </div>
      <div class="item estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio2.webp" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/y4o27e" name="Sol y Luna" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio2.webp" alt="">
          </a>
      </div>
      <div class="item gts estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio3.webp" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/99wodj" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio3.webp" alt="">
          </a>
      </div>
      <div class="item gts estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio4.webp" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio4.webp" alt="">
          </a>
      </div>
      <div class="item gts estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio5.webp" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio5.webp" alt="">
          </a>
      </div>
      <div class="item estet col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio6.webp" class="popup-image fancylight popup-btn"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio6.webp" alt="">
          </a>
      </div>
      <div class="item abog col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio10.jpg"
              class="popup-image fancylight popup-btn with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio10.jpg" alt="">
          </a>
      </div>
      <div class="item tecnico col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio11.webp"
              class="popup-image fancylight popup-btn with-caption image-link"
              data-link="https://wa.link/99wodj" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio11.webp" alt="">
          </a>
      </div>
      <div class="item tecnico col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio12.webp"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio12.webp" alt="">
          </a>
      </div>
      <div class="item tecnico col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio13.webp"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio13.webp" alt="">
          </a>
      </div>
      <div class="item lava col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio16.jpg"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio16.jpg" alt="">
          </a>
      </div>
      <div class="item tecnico col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio21.jpg"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio21.jpg" alt="">
          </a>
      </div>
      <div class="item tecnico col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio25.jpg"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio25.jpg" alt="">
          </a>
      </div>
      <div class="item clases col-lg-3 col-md-4 col-6 col-sm gallery">
          <a href="/img/negocio26.jpg"
              class="popup-image fancylight popup-bt with-caption image-link"
              data-link="https://wa.link/y4o27e" data-fancybox-group="light">
              <img class="img-fluid" src="/img/negocio26.jpg" alt="">
          </a>
      </div>

  </div>
</div>
</main>






<!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
<script src="https://kit.fontawesome.com/dd84e1b5c1.js" crossorigin="anonymous"></script> -->

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
    <script src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js"></script>
    <!-- <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script> -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
    
    <script src="https://kit.fontawesome.com/dd84e1b5c1.js" crossorigin="anonymous"></script>

<script>
  $(window).on('load', function () {
    console.log("üîÅ DOM completamente cargado");

    const $images = $('.popup-image');

    if ($images.length === 0) {
      console.warn("‚ö†Ô∏è No se encontraron elementos .popup-image");
      return;
    }

    if ($.fn.magnificPopup && $images.data('magnificPopup')) {
      $images.magnificPopup('destroy');
      console.log("üßπ magnificPopup destruido antes de volver a inicializar");
    }

    $images.magnificPopup({
      type: 'image',
      gallery: { enabled: true },
      callbacks: {
        open: function () {
          console.log("‚úÖ Popup abierto");
          agregarBotonEnlace(this.currItem);

          lottie.loadAnimation({
            container: document.getElementById('lottie-prev'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '/json/arrow-left.json'
          });
          lottie.loadAnimation({
            container: document.getElementById('lottie-next'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '/json/arrow-right.json'
          });
          lottie.loadAnimation({
            container: document.getElementById('lottie-close'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: '/json/close.json'
          });

          $(document).off('click.lottie');
          $(document).on('click.lottie', '#lottie-prev', () => $.magnificPopup.instance.prev());
          $(document).on('click.lottie', '#lottie-next', () => $.magnificPopup.instance.next());
          $(document).on('click.lottie', '#lottie-close', () => $.magnificPopup.close());
        },
        close: function () {
          console.log("üõë Popup cerrado");
          $('.popup-controls-wrapper').remove();
        }
      }
    });

    function agregarBotonEnlace(item) {
      console.log("üëâ Ejecutando agregarBotonEnlace");

      if (!item.el || !item.el.attr) {
        console.warn("‚ö†Ô∏è item.el no v√°lido:", item);
        return;
      }

      const link = item.el.attr('data-link');
      const nombre = item.el.attr('name') || 'Contacto';

      const html = `
        <div class="popup-controls-wrapper">
          <div id="lottie-prev" class="lottie-button"></div>
          <div class="popup-button">
            <a href="${link}" target="_blank">
              <i class="fa-brands fa-whatsapp fa-lg" style="color: #ffffff;"></i> ${nombre}
            </a>
          </div>
          <div id="lottie-next" class="lottie-button"></div>
          <div id="lottie-close" class="lottie-button"></div>
        </div>
      `;

      $('.mfp-wrap').append(html);
    }
  });
</script>
</body>
</html>
